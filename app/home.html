<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>What To Do?</title>
    <!-- jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!-- Socket.io -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.4/socket.io.js"></script>
    <!-- Bootstrap JavaScript -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
    <!-- Bootstrap css -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
    <!-- Stylesheet-->
    <link rel="stylesheet" type="text/css" href="../styles.css">
    
</head>

<body>
    <form action="">
        <div class "container">
            <div class="card">
                <article class="card-body">
                    <a href="/signin" class="float-right btn btn-outline-primary">Sign Out</a>
                    <h4 class="card-title text mb-4 mt-1">What To Do?</h4>
                    <hr>
                    <div class="form-group-center text-center">
                    <div class="input-group-center text-center"> 
                    <div id="list">    
                        <h5 id="user" class="text-center">{{username}}'s To Dos</h5><br>
                        <ul id="todos"></ul>
                        <input id="newTask" class="form-control-sm " placeholder="What To Do?" autocomplete="off" />
                        <button type="submit" class="btn-sm btn-primary btn-block-sm">Add</button>
                    </div> <!-- div list -->
                    </div> <!-- input-group -->
                    </div> <!-- form-group -->
                </article>
            </div>
        </div>
    </form>
        
    <script> 
        $(function(){
            const socket = io.connect("http://localhost:3000/");
            /* const username = document.getElementById("user");
            username.innerText = `${task.username}`; */
            console.log(socket);
    
                $('form').submit(() => {
                const task = $('#newTask').val();
                socket.emit("tasks", task);
                $('#newTask').val('');
                return false;

                $('#todos li').click(() => {
                    $(this).addClass('checked', () => {
                        $(this).css("text-decoration, line-through");
                    });
                }); 
            });

    
            //bliver kaldt, nÃ¥r der addes task
            //data der sendes 
            socket.on("tasks", tasks => {
                console.log("tasks", tasks);
                const tasksElement = document.getElementById("todos"); //<ul></ul>
                
                for (const task of tasks) {
                    const taskElement = document.createElement("li");
                    taskElement.innerText = `${task.task}`; // <li>Besked</li>
    
                    tasksElement.appendChild(taskElement); // adds <li> to the <ul>
                };
            }); 
        });
    </script>
</body>
</html>